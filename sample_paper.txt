Abstract
Following the sequence and structure revolutions, predicting functionally relevant protein structure changes at scale remains an outstanding challenge. We introduce BioEmu, a deep learning system that emulates protein equilibrium ensembles by generating thousands of statistically independent structures per hour on a single graphics processing unit (GPU). BioEmu integrates more than 200 milliseconds of molecular dynamics (MD) simulations, static structures, and experimental protein stabilities using new training algorithms. It captures diverse functional motions—including cryptic pocket formation, local unfolding, and domain rearrangements—and predicts relative free energies with 1 kilocalorie per mole accuracy compared with millisecond-scale MD and experimental data. BioEmu provides mechanistic insights by jointly modeling structural ensembles and thermodynamic properties. This approach amortizes the cost of MD and experimental data generation, demonstrating a scalable path toward understanding and designing protein function.
SIGN UP FOR THE AWARD-WINNING SCIENCEADVISER NEWSLETTER
The latest news, commentary, and research, free to your inbox daily
Proteins and protein complexes are the functional building blocks of life and play a central role in drug development and biotechnology. Although next-generation sequencing and deep learning–based structure prediction tools (1–4) have revolutionized access to sequence and structure, scalable methods for exploring protein function remain elusive. A key driver of protein function is the ability to transition between distinct conformational states (i.e., sets of different structures), often coupled to the binding of ligands or other proteins. For example, actin’s ability to form muscle fibers arises from its conformational dynamics, which is regulated by adenosine triphosphate (ATP) and adenosine diphosphate (ADP) (Fig. 1A).

Fig. 1. Overview of model and architecture.
(A) Actin as a representative example of protein function driven by conformational changes. Actin filament formation depends on an open-close transition of monomers, which is controlled by ADP and ATP binding. (B) Given a protein sequence, BioEmu samples protein structures from an approximate equilibrium distribution, from which properties such as free-energy differences can be computed. [Emu illustration by F.N.] (C) ML model architecture consisting of protein sequence encoder, denoising diffusion model, and score model. The protein structure is represented using coarse-grained backbone frames. (D) Data integration and model training pipeline. (E) Data processing pipeline for pretraining. MLP, multilayer perceptron; repr., representation; feat., features.
Technologies in use now that quantitatively probe such conformational transitions and their coupling with binding states are not scalable. Single-molecule experiments can provide the full equilibrium distributions of observables such as intramolecular distances (5) but require bespoke molecular constructs and time-consuming data collection. Cryo–electron microscopy (cryo-EM) can resolve multiple conformational states of biomolecular complexes and their probabilities (6), but these experiments are time-consuming and costly. Molecular dynamics (MD) simulation is, in principle, a universal tool that allows both the structure and dynamics of biomolecules to be explored at all-atom resolution. However, biomolecular force fields are far from perfect, and the sampling problem makes studying protein folding or association with MD a feat of epic computational costs—even with special-purpose supercomputers or enhanced sampling methods (7, 8). Machine-learned (ML) coarse-grained MD models have an opportunity to achieve similar accuracy as all-atom MD at two to three orders of magnitude lower computational cost (9, 10) but are still under development.
The grand challenge to complete our understanding of protein function thus motivates the development of a technology that can elucidate protein conformational states and binding states, as well as their associated probabilities. This technology should ideally achieve an accuracy comparable to that of a converged MD simulation, or a cryo-EM experiment with multiconformation analysis, but it should only require a few hours of wall-clock time and cost no more than a few dollars per experiment. Boltzmann generators (11) have demonstrated that physics-based generative ML models can sample equilibrium distributions of arbitrary molecular energy functions; however, scaling such approaches to large macromolecules while maintaining high sample efficiency is challenging. Concurrently, data-based generative ML models, such as diffusion models, are now widely used in protein-structure prediction and design (2, 4). Such models (12–14), as well as perturbation-based derivatives of AlphaFold (15, 16), have also been shown to be capable of generating distinct protein structures and can be combined with MD simulation to alleviate the sampling problem (17). As of yet, generative ML systems have mainly demonstrated an ability to qualitatively sample distinct protein conformational states. A demonstration that generative ML can quantitatively match equilibrium ensembles and predict experimental observables is critical going forward (18).
Model
We developed a biomolecular emulator called BioEmu—a generative deep-learning system designed to approximately sample from the equilibrium distribution of protein conformations. BioEmu uses a similar model architecture as Distributional Graphormer (DiG) (12) but employs a distinct training approach. Starting from the input protein sequence, single and pair representations of the sequence are computed using the AlphaFold2 evoformer (1). This sequence representation serves as input to a denoising diffusion model that generates protein structures (Fig. 1, B and C, and materials and methods). Sequence encoding is performed only once per protein, and an efficient integration scheme enables structure generation in as few as 30 to 50 denoising steps (fig. S11 and materials and methods). As a result, 10,000 independent protein structures from the learned equilibrium distribution can be sampled within minutes to a few hours on a single graphics processing unit (GPU), depending on their size.
A major challenge in training BioEmu is the absence of a single high-quality data source for protein equilibrium distributions, owing to the aforementioned challenges with experimental methods and MD (19). We therefore integrated training data from different, complementary sources. BioEmu was pretrained on a clustered version of the AlphaFold database (AFDB) using a data augmentation strategy that encourages it to sample diverse conformations (Fig. 1, D and E, and materials and methods). In a second stage, we continued training the model on more than 200 ms of all-atom MD data of thousands of small to medium-sized proteins (Fig. 1D, table S1, and materials and methods). To mitigate the sampling problem, MD data were reweighed toward equilibrium using either Markov state models (20) or weights from experimental data, when possible (materials and methods). Finally, we fine-tuned the model on 500,000 sequences of the MEGAscale dataset (21), a large-scale, homogeneous collection of in vitro protein stability measurements (Fig. 1D). As the MEGAscale dataset does not contain structures, we developed a new algorithm called property-prediction fine-tuning (PPFT) that can efficiently incorporate experimental measurements into diffusion model training (see section “Predicting protein stabilities” and materials and methods). To ensure generalization, we filtered our training set such that no protein had more than 40% sequence similarity to a predefined holdout set, including all reported test proteins of at least 20 residues or longer. The term “BioEmu” refers to the fine-tuned model, trained on AFDB, MD simulations, and experimental protein-stability measurements. Subsequent results used this model unless otherwise indicated.
Sampling conformational changes related to protein function
We consider the ability to qualitatively sample distinct, biologically relevant conformations as a foundation for building a quantitative equilibrium sampler. Therefore, we first tested whether BioEmu could predict known conformational changes and compared this capability with AFCluster (15), AlphaFlow (13), DiG (12), and uniform multiple-sequence alignment (MSA) subsampling (22) as representative baseline methods (materials and methods). To benchmark BioEmu’s ability to capture functionally relevant structural variability, we curated four benchmark sets comprising around 100 proteins with experimentally validated transitions (figs. S1 to S4). The first set, OOD60, assesses sequence generalization. The remaining three sets target specific types of conformational change: domain motions, local unfolding transitions, and cryptic pocket formations.
OOD60 is designed to test strong generalization: Its proteins were deposited in the Protein Data Bank (PDB) after the AlphaFold2 cutoff date and share no more than 60 and 40% sequence similarity with the AlphaFold2 monomer model and BioEmu training sets, respectively. OOD60 includes various challenging cases such as large-scale conformational changes induced by binding with other biomolecules (fig. S1). BioEmu significantly outperformed all baselines on this benchmark (fig. S7). For the other benchmarks, BioEmu matched or exceeded baseline performance, except in predicting apo states of cryptic pockets, where AFCluster performed best. The performance gap was especially pronounced for proteins outside the AlphaFold2 training set (fig. S7).
The domain motion benchmark consists of proteins that undergo large-scale motions as part of their functional cycle (Fig. 2A). In the open-close transition of adenylate kinase, the closed state brings the substrates together to catalyze the 
 reaction. Single-molecule experiments have confirmed that opening and closing occurs reversibly on timescales of tens of microseconds when the substrates are bound (23). BioEmu predicts a range of open and closed states, including close matches with crystallographic structures. A second example is the open-close transition of LAO-binding protein, which is required to bind and release lysine, arginine, and ornithine for transport across membranes as part of the ATP-binding cassette protein family. Another interesting example of domain motions is that of the receptor module that regulates the concentration of cyclic di–guanosine monophosphate (cyclic-di-GMP) in bacteria. In this case, one domain undergoes a large-scale rotation and repacks to the other domain with a completely different contact pattern. See fig. S2 for 19 further examples. Overall, BioEmu predicted 83% of the reference experimental structures with ≤3-Å root mean square deviation (RMSD) (Fig. 2A), indicating the model’s ability to predict which protein regions are rigid and which are flexible, as well as which resulting motions can occur.

Fig. 2. BioEmu samples functionally distinct protein conformations.
(A) Large-scale domain motions. (B) Local unfolding or unbinding of parts of the protein. (C) Formation of cryptic binding pockets that are not present in the apo ground state. The left column shows the coverage of pretrained and fine-tuned BioEmu models, defined as the percentage of reference structures that are sampled by at least 0.1% of samples within a given distance. Global and local RMSD are used for domain motions and cryptic pocket formation benchmarks, respectively, and the fraction of native contacts for local unfolding. Successful coverage of reference states is defined by probability density left of and below the dashed lines in the energy landscape plots of (A) and (C) and outside the dashed lines in (B). BioEmu sampled structures are shown in green, PDB structures in gray, and key secondary structure elements in blue. CaM, calcium-calmodulin dependent; LAO, lysine arginine ornithine. See table S4 for 12-letter PDB codes and original citations.
Next, we considered local unfolding transitions, in which part of a protein chain unfolds or detaches from its main structure as part of a signaling pathway (Fig. 2B). Predicting local unfolding challenges the model to correctly rank the relative stabilities of a protein’s fold. A famous example of local unfolding is Ras p21, a protein whose mutants are often linked to cancer development; the local unfolding of Ras p21 is a conformational switch that signals cell growth (24). In its active state, stabilized by binding guanosine triphosphate (GTP), the switch II region forms a short α helix, which partially unfolds in the inactive guanosine diphosphate (GDP)–bound state. Rhomboid intramembrane protease is a more complex case that involves domain swapping. Its monomeric form features a globular conformation, whereas in its dimeric form, the central β sheet unfolds and the helices of the two monomers bind to each other. Finally, CaM kinase II presents an autoinhibition mechanism, wherein the N terminus binds into the active site. BioEmu correctly predicted the local unfolding of these structure elements and sampled 70% of the folded and 81% of the locally unfolded states across 20 protein examples (Fig. 2B and fig. S3).
As a final class of conformational changes, we considered the formation of pockets that are absent in the apo PDB structure but can form to bind a small molecule (Fig. 2C). Such “cryptic” binding pockets can be discovered with high-performance MD simulation (25, 26), but the millisecond timescales often involved in the spontaneous opening of such pockets make MD on commercial hardware rarely viable for in silico drug-discovery pipelines. We curated 34 cases of experimentally validated formation of cryptic binding pockets from the literature (fig. S4). The sialic acid binding factor presents a case where a large opening in the apo state can partially close and form a binding site for the ligand. Fascin is a four-domain protein where two domains can rotate with respect to each other to reveal a binding site. In Glu PRPP amidotransferase, part of the chain is unfolded in the apo state and can fold into a structure that completes the binding site for the ligand. To ensure capturing subtle changes, we defined success by a very strict 1.5-Å RMSD threshold to the apo and holo reference structures. Surprisingly, the model had a strong preference for holo states, successfully predicting the cryptic pocket in 86% of cases, whereas it only succeeded in predicting 56% of the apo structures, indicating further room for improvement (Fig. 2C). We hypothesize that the model may be picking up a bias implicit in the embeddings—proteins may have only one or a few apo structures deposited in the PDB, but it is common to find multiple structures of the same protein with different small molecules bound.
To conclude, we conducted several tests to confirm that BioEmu’s multiconformation prediction is a hallmark of generalization rather than memorization of sequence-structure pairs. BioEmu’s ability to predict multiple conformations depends only weakly on the sequence similarity between the query molecule and the training set, with the clearest trend seen for domain motions where the final performance is reached at 30% sequence similarity (fig. S5 and materials and methods). As our test proteins contain examples that overlap with the AlphaFold2 training set, we ablated whether multiconformation prediction performance stems from trivial extraction of the information already present in the AlphaFold2 evoformer embeddings. To this end, we trained an end-to-end version of the model that uses MSA information directly, instead of pretrained embeddings, on a training set that is at most 40% similar in sequence to any protein belonging to the multiconformation benchmarks. The resulting model showed similar performance in the previously mentioned multiconformation benchmarks to that of the fine-tuned BioEmu (fig. S6 and materials and methods).
Emulating MD equilibrium distributions
A major motivation for developing BioEmu was to overcome the well-known sampling problem in MD: Simulating the full range of protein conformations and estimating their equilibrium probabilities often requires extensive MD simulations, on the order of 100 μs to 10 ms (7, 8, 27). These timescales are necessary to capture rare but functionally important transitions, yet achieving them is computationally demanding, if not prohibitive, even with specialized supercomputers (28) or large-scale distributed simulations integrated using statistical models (8, 29). Here, we assessed BioEmu’s ability to emulate the equilibrium distribution that would be sampled with extensive MD simulations. To this end, we amassed all-atom simulations of proteins with a total aggregated simulation time of more than 200 ms (table S1), which were used for fine-tuning BioEmu (Fig. 1D).
Before analyzing the model trained on the full dataset, we first tested whether our machine-learning architecture and training protocol permit learning to emulate long-timescale MD equilibrium distributions. To this end, we used D. E. Shaw Research (DESRES) simulations of 12 fast-folding proteins generated on the Anton supercomputer (7). For each protein, we fine-tuned a separate model on the other 11 proteins and evaluated it on the held-out 12th, an approach known as leave-one-out cross-validation (see materials and methods). This setup ensures that each test case is evaluated independently of its training data and avoids bias from arbitrary train-test splits in this small dataset. As expected, the AFDB-pretrained model predicted the native state but performed poorly in sampling the full free-energy surface (fig. S9). Surprisingly, however, the “DESRES–fine-tuned models,” each trained on only 11 fast folders, predicted free-energy surfaces on the held-out proteins that closely matched the MD ground truth (Fig. 3A and fig. S9). For all proteins, the model predicted both the native as well as the unfolded states with similar shapes on the free-energy landscape. In many cases, several or all folding intermediates visible on the two-dimensional (2D) free-energy surface were predicted (Fig. 3A and fig. S9): For beta-beta-alpha protein (BBA), both MD and the DESRES–fine-tuned models predicted the existence of an intermediate with the α helix formed and the β sheet broken. For protein G, both MD and the DESRES–fine-tuned model sampled intermediates with half of the β sheet still formed, whereas the other half and most of the helix were broken. For homeodomain, MD and the model agreed in the prediction of an intermediate with only one helix turn unwound, whereas the unfolded states still featured some degree of helical propensity. There was excellent agreement of the predicted secondary structure propensities with the MD data (Fig. 3A). Quantitatively, the mean absolute error between the MD and model 2D free-energy landscapes was only 0.74 kcal/mol, ranging from 0.30 kcal/mol for BBA to 1.63 kcal/mol for λ-repressor, which is on the order of differences expected from two different classical MD force fields (30, 31).

Fig. 3. BioEmu achieves fast emulation of all-atom MD equilibrium distributions.
(A) DESRES fast-folding proteins. From left to right are representative structures (green, model; gray, MD; blue, regions of interest), free-energy surfaces over slowest time-lagged independent components (TIC) (54), secondary structure propensities, computational cost for MD (magenta, full DESRES data; yellow, single folding-unfolding roundtrip) versus model (cyan, 10,000 samples), and mean absolute error (MAE) of free-energy differences and fraction of unphysical model samples. (B) CATH domains. Structures, free-energy surfaces, and errors are as in (A). Shown at the bottom right is data scaling for the specialized CATH-only model with free-energy MAE and state coverage as a function of training data. The cyan star indicates BioEmu. (C) Complexin II: Structures, helix content, and radius of gyration (Rg) as predicted by BioEmu versus two all-atom force fields. (D) Tetraspanin CD9 results from BioEmu and MD (37). Shown is the open-closed transition, represented as a histogram in logarithmic scale of small and large extracellular loop (SEL-LEL) contacts, as defined in (37). Two-dimensional principal components (PC) analysis of exp(−dij) of Ca-Ca distances dij between SEL and LEL. The open star marks the experimental structure (6k4j).
We compared the computational costs of MD data generation and BioEmu in GPU-hours (on a NVIDIA Titan V; Fig. 3A, top right). For all BioEmu results shown here, we drew 10,000 samples, which incurred computational costs of less than 1 GPU-minute for Chignolin to around 1 GPU-hour for λ-repressor. For MD, we considered the cost for generating the DESRES simulations, whose lengths were chosen to include roughly 10 folding-unfolding transitions. The MD costs then ranged from 2000 GPU-hours for Chignolin to more than 100,000 GPU-hours for NTL9, resulting in a speedup of BioEmu over MD of four to five orders of magnitude. We also note that for most proteins shown here, performing sufficiently long MD simulations to directly observe folding and unfolding in single trajectories is still not possible on consumer-grade hardware but instead requires a much more complex methodological framework (29, 32).
The main BioEmu model was fine-tuned on more than 200 ms of MD simulations with Amber force fields at or near a temperature of 300 K (table S1). We chose to combine data from slightly different simulation conditions because each of these MD models is inherently imperfect, and we regarded experimental data as being more reliable for weighing between conformations (Fig. 1D). Differences in the simulation conditions of our own generated data were intentional; for example, AMBER ff99sb-disp (33) was chosen to avoid spuriously misfolded states produced by other force fields in the context of protein folding (materials and methods). A large fraction of training data, 46 ms, is dedicated to 1100 CATH domains, common building blocks of protein structure (34) (materials and methods). We designated 17 CATH systems with a simulation time of more than 100 μs as a test set and report statistics comparing MD and model distributions (Fig. 3B, fig. S10, and materials and methods). Similar to DESRES simulations, BioEmu predicts the native state with local fluctuations and typically several other substates and structures sampled by MD. Most secondary structure propensities matched well (Fig. 3B). We observed a free-energy mean absolute error over the converged test set of 0.9 kcal/mol, which was again comparable to the differences expected between different MD force fields.
To understand whether our model’s ability to sample accurate equilibrium distributions is limited by training data or model expressivity, we trained three models with the same architecture as BioEmu from scratch, using only 1, 10, and 100% of the CATH systems in the training dataset. We observed decreased free-energy errors and an increased coverage of the conformations sampled by MD as the amount of training proteins increased (Fig. 3B, bottom right), suggesting that the model can be further improved by adding more training data. Notably, the fine-tuned model’s error on the same test set was further reduced to 0.9 kcal/mol, demonstrating the potential benefit of pretraining and integrating multiple datasets even if they do not use identical simulation conditions.
Finally, we evaluated BioEmu for two case studies that involve larger proteins: complexin II (134 amino acids) and tetraspanin CD9 (225 amino acids). Complexin II is an intrinsically disordered protein (IDP) from the neurotransmitter release apparatus (35). IDPs tend to be difficult to sample with MD; however, BioEmu can efficiently emulate a flexible ensemble of complexin II structures (Fig. 3C) while reproducing known secondary structure elements such as the central and accessory helices (35, 36). Achieving convergence of IDPs of this size with all-atom MD is unpractical. At an order of magnitude higher computational cost than with BioEmu, we conducted ~5 μs of MD simulations with all-atom MD, which are most likely not converged but already display qualitatively different behavior: The AMBER ff14sb force field produced a very rigid compact structure with a small radius of gyration and little to no variation in secondary structure content, whereas AMBER ff99sb-disp tended to destabilize known secondary structure elements (Fig. 3C).
Tetraspanin CD9, the second case study, plays a role in cell adhesion and fusion (Fig. 3D). The large extracellular loop of CD9 is part of our OOD60 test set (fig. S1) in which our pretrained model samples both crystallographic reference structures (PDB entries 6rlo and 6rlr), whereas the BioEmu model fine-tuned on MD data samples 6rlo but discards 6rlr. This is consistent with the observation that both structures exist in crystal environments; however, 6rlr cannot be realized in a folded monomeric protein and is therefore correctly discarded when fine-tuning BioEmu (fig. S12, A to C). We also sampled the full-length CD9 structure, which has less than 40% sequence similarity to both the BioEmu and AlphaFold training sets (Fig. 3D). In agreement with MD simulations of previous work (37), BioEmu predicted the widely open state 1 and closed state 2 and similar contact distributions between the small and large extracellular loops as reported in (37). A principal components analysis revealed that BioEmu and MD sample similar sets of conformations (Fig. 3D). MD predicts an experimentally unknown metastable closed state 3, which is unstable in BioEmu. BioEmu samples closed structures (state 2) that are very similar to the experimental structure 6k4j (1.9-Å RMSD), whereas the closest MD sample has an RMSD of 4.6 Å to the crystal structure (fig. S12D).
Predicting protein stabilities
Understanding protein stability is crucial for various applications in molecular biology, drug design, and biotechnology. From a modeling point of view, predicting a protein’s stability is a specific case of predicting the equilibrium probabilities of its different conformational states, and these all arise from the same underlying biophysics. We therefore wanted to train BioEmu so that the proportion of samples in folded and unfolded states matches the experimentally measured protein stability. We classify protein structures as folded or unfolded based on their fraction of native contacts and define the folding free-energy as ΔG = Gfolded − Gunfolded (materials and methods). To facilitate protein stability prediction, BioEmu was trained on 502,442 mutant sequences generated from 361 wild types, a subset of the more than 674,000 experimental measurements in the MEGAscale dataset (materials and methods) (21). We evaluated BioEmu on a test set of randomly chosen mutants from 95 wild types. For a subset of 271 wild-type proteins and 21,458 mutants, we additionally conducted a total of 25 ms of all-atom MD simulations of the folded and unfolded states (materials and methods). To address MD sampling and force-field issues, we weighed the folded and unfolded samples based on the experimentally measured protein stabilities (materials and methods). To accelerate training convergence and leverage the large number of MEGAscale measurements, we developed the PPFT algorithm (Fig. 4A and materials and methods), which integrates experimental expectation values, such as protein stabilities, into diffusion model training without requiring protein structures. PPFT uses fast approximate sampling with only eight denoising steps, which we observed to be sufficient to confidently predict whether each sampled structure will be classified as folded or unfolded. By comparing the mean foldedness of sampled structures with experimental measurements and backpropagating the error, our model could be efficiently trained to match experimental protein stabilities.

Fig. 4. Prediction of experimentally measured protein stabilities.
(A) PPFT algorithm for fine-tuning a pretrained diffusion model to match experimentally measurable properties such as the protein’s stability. (B) Comparison of experimental measurements of folding free energies (21) with model predictions, generated by direct sampling and counting of folded and unfolded states for test proteins, the mean absolute error (MAE), and the Spearman correlation coefficient as a function of the sequence similarity between test and training proteins. The gray shaded region represents an error range of ±1 kcal/mol. (C) Same as (B) for the change in folding stability upon point mutation. (D) Validation that very stable proteins that are not included in the MEGAscale experimental dataset are consistently predicted as folded. Bars and shading indicate the minimum, maximum, and distribution of sampled values, respectively. (E) Validation that IDPs reported in (39) and (41) are predicted as unfolded. Comparison of the radius of gyration (Rg) for model (orange crosses), experimental measurement (blue dots), and Flory scaling (55). (F) Analysis of the effect of two destabilizing mutants on the folded structures as predicted by the model: HHH_rd1_0335 with mutation I7P and 2JWS with mutation I24D. See table S4 for 12-letter PDB codes and original citations. WT, wild type.
BioEmu achieved a mean absolute error of less than 0.9 kcal/mol and a Spearman correlation coefficient of approximately 0.6 for the MEGAscale test proteins (Fig. 4B). The BioEmu ensembles also correlated well with stability changes of point mutants, as measured by the change of folding free energy ΔΔG, achieving mean absolute errors of less than 0.8 kcal/mol and a Spearman correlation coefficient above 0.6 (Fig. 4C). Errors of approximately 1 kcal/mol were achieved for test proteins that had 40% sequence similarity with the training set, but the best performance was obtained for test sets that included sequences with 50% or greater similarity (Fig. 4, B and C). As there are only 361 distinct wild-type sequences in the MEGAscale training data, it is likely that generalization performance can be further improved with a training dataset that is more diverse in protein sequence space.
To check whether BioEmu makes physically reasonable predictions outside the MEGAscale set of proteins, we tested it on proteins that are known to be very stable or unstable. We first selected stable proteins from ProThermDB (38) with a ΔG <−8 kcal/mol (materials and methods). Our model consistently sampled these proteins in their folded states with a fraction of native contacts that always exceeded 0.65 (Fig. 4D). To test whether our model systematically predicts IDPs as unfolded, we used the CALVADOS test set (39). Most proteins sampled displayed a radius of gyration (Rg) similar to that of random coil structures and mostly larger than that of typical folded proteins (Fig. 4E). Unlike other models (40, 41), ours has not been directly trained on IDPs; nonetheless, it provides zero-shot predictions of Rg that correlate well with experimental measurements (Fig. 4E).
In comparison to black-box methods that predict protein stability directly from sequences (42–45), BioEmu has competitive or superior prediction accuracy. However, in contrast to a black-box prediction of ΔG, we can analyze the structure ensemble generated by our model to reveal insights on mutation-caused stability changes. To illustrate this point, in Fig. 4F, we show mutants of the design protein HHH_rd1_0335 and PDB entry 2JWS. In HHH_rd1_0335, the mutation I7P (Ile7→Pro) leads to a destabilization of the first helix, as indicated by the model’s prediction of a ΔΔG of 1.8 kcal/mol compared with the experimental 2.1 kcal/mol. The analysis shows a decrease in average helicity that particularly affects the helix where the mutation is located. For 2jws, the mutation I24D (Ile24→Asp) in the middle helix results in partial unfolding, with the model predicting a ΔΔG of 2.1 kcal/mol, which closely matches the experimental value of 2.9 kcal/mol. This mutation replaces a hydrophobic residue with a negatively charged aspartate, disrupting core stability and leading to a localized structural change. These analyses highlight BioEmu’s ability to correlate predictions of thermodynamics with structural causes, which is not possible with black-box prediction models.
Discussion
In this work, we introduce BioEmu, a generative machine-learning system that can approximately sample the equilibrium distributions of proteins and through that explore two key aspects of molecular function: protein conformations and their equilibrium probabilities. We have shown that the system can sample experimentally known structures of proteins undergoing a variety of conformational changes, approximate the equilibrium distributions of extensive MD simulations, and predict experimentally measured protein stabilities within errors of 1 kcal/mol. The cost of running inference is on the order of 1 GPU-hour per computational experiment, which is many orders of magnitude less than running MD simulations, even if enhanced sampling methods are invoked, and orders of magnitude cheaper than experiments that can provide detailed structure-function relationships. Nonetheless, there are further opportunities to reduce BioEmu’s inference cost. Conditional flow-matching (46) can be used to generate protein structures using even fewer integration steps (47). The computational cost of evaluating the transformer network in the score model (Fig. 1C) can potentially be reduced by leveraging sparse or low-rank attention mechanisms.
BioEmu and MD simulation are complementary: Our system was trained on large amounts of MD simulation data for soluble proteins, and within this scope, it has shown that it can approximate MD distributions at a tiny fraction of the MD simulation costs. However, BioEmu is not designed to generalize beyond this scope; for example, membrane environments and small-molecule ligands are not represented in either the model or the training data, and reliable predictions cannot be assumed when such factors play a key role in the process. By contrast, MD can be readily generalized to such conditions, though it remains constrained by the sampling problem. Our system can be used to generate an approximation to the equilibrium distribution, and MD trajectories can be launched from a BioEmu ensemble to obtain chemically accurate all-atom structures, refine the distribution, and even compute dynamical properties. We therefore do not expect emulators such as BioEmu to make MD simulation obsolete; rather, we anticipate that MD will increasingly serve as a data generation and validation tool. A similar shift of roles is already in progress for other simulator-emulator pairs such as quantum chemistry methods and machine-learned force fields.
An important limitation of BioEmu is that it generates distributions entirely empirically, whereas MD simulation uses potential energy functions, which are connected to equilibrium distributions and expectation values by statistical mechanics. If direct access to a reduced potential energy function u(x) was available that is consistent with the generated distribution by p(x) ∝ e−u(x), it could be used for reweighting and making rigorous enhanced sampling simulations available through the emulator. BioEmu can potentially also be improved by going beyond score matching and using energy or forces information from MD force fields at training time, as considered in Boltzmann generators (11) and variational force matching (9, 48).
Although BioEmu samples approximate equilibrium distribution, it does not model protein dynamics, which is done by MD and other methods (49), nor does its training incorporate dynamical information as it does for Markov state models (20). A pragmatic approach to generate a dynamic ensemble is to predict starting points with BioEmu and launch MD simulations from them. A starting point for a more principled methodology that can both model dynamics and exploit dynamical information in the training data is the implicit transfer operator approach (50).
We have demonstrated that by using the PPFT method developed here, BioEmu can be efficiently fine-tuned on experimental data. In this work, we have chosen to do that for protein stabilities using the MEGAscale dataset because it presents a very favorable trade-off of large data scale and quantitative reliability. However, in principle, PPFT can be used to fine-tune BioEmu and other diffusion models to match any set of experimental observables, including nuclear magnetic resonance data, small-angle x-ray scattering, fluorescence measurements, and so on. Being able to fine-tune the generated ensemble to arbitrary experimental data is an important advantage compared with MD force fields: These can also be tuned to fit experimental data (51), but the processes that give rise to the experimental observables must be sampled during the training process, a task that is tedious or even unfeasible for observables that involve complex rare events, such as folding free energies.
A widely used feature of AlphaFold is its ability to predict confidence in an output structure, and a similar confidence module for BioEmu would be highly desirable. Training a confidence module is relatively straightforward in AlphaFold, which serves a single prediction task (structure) and relies on a single ground truth dataset (the PDB), whereas equilibrium structure ensembles serve multiple downstream tasks and observables and no universal ground truth dataset is available. Confidence prediction or uncertainty quantification of arbitrary observables thus remains an important future research direction and may leverage ongoing research in the deep-learning community (52). Even a rough notion of model confidence in observables, such as free-energy differences, could be exploited to improve training data efficiency: In the MD community, Markov state models and other kinetic models have been used to guide MD data production in an active learning loop (8, 53), and a similar approach could be implemented to have BioEmu request new MD or experimental data that are most likely to increase model confidence.
Another limitation of the present system is that it emulates single protein chains under a fixed thermodynamic condition of 300 K. A proper emulator for proteins requires conditioning on experimentally and biologically relevant parameters such as temperature and pH and needs to be able to model multiple interacting molecules, as proteins rarely have a function on their own. We envision two ways of achieving this: (i) training on additional MD simulation data at relevant thermodynamic ranges and (ii) incorporating relevant additional experimental data (e.g., melting curves for temperature) into fine-tuning strategies.
An important future direction is to extend BioEmu’s modalities by incorporating multiple protein chains and ligands, which are already included in recent biomolecular structure prediction systems (2, 4). Presently, oligomer and ligand binding state are implicit, which may cause biases in the training data to show up in the sampled distribution. A hallmark of this may be BioEmu’s preference to predict holo over apo structures in the cryptic pocket benchmark (Fig. 2C). Such biases in the sampling distribution can be avoided by explicitly conditioning the prediction of the structure ensemble to ligands, which is, however, hampered by the lack of training data. Although we have shown that the ability to accurately emulate the equilibrium distributions of small proteins increases with more training data, the sampling problem limits MD as a data-generation engine. The development of highly scalable experimental techniques is key for training machine-learning models that can predict conformational and binding states of large biomolecular complexes, as well as the subtle differences of binding affinities that underlie biomolecular function.
Our results demonstrate that the large upfront costs of MD simulation and experimental data generation can be amortized by a deep-learning emulator whose prediction error decreases with an increasing amount of high-quality training data. This indicates a path forward for predicting biomolecular function at the genomic scale.
Materials and methods are available in the supplementary materials.